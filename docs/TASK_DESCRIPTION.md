# Описание задач

## Список задач

```
gulp/tasks
| files.js
| fonts.js
| html.js
| img.js
| js.js
| reset.js
| scss.js
| server.js
| sprite.js
```

## Сценарии

__Основной сценарий (_main_)__ - последовательно запускаеет следующие задачи:

```
|- files
|- fonts
|- sprite
|- параллельно запускает html, scss, js, img
```
__Сценарий разработки (_dev_)__ последовательно запускаеет следующие задачи:

```
|- reset
|- сценарий main
|- параллельно вешает watcher (на задачи html, scss, js, img) и запускает server
```

__Сценарий сборки (_build_)__ последовательно запускаеет следующие задачи:

```
|- reset
|- сценарий main
```

## Основные команды

`npm run serve` - запускает задачи сценария __dev__ в режиме разработки

`npm run build` - запускает задачи сценария __build__ в режиме сборки

## Задачи

`files`

- получает содержимое папки files из папки с исходниками проекта 
- копирует полученное содержимое в папку с билдом

`fonts`

- получает шрифты в формате .ttf из папки fonts в исходниках проекта
- конвертирует шрифты в форматы woff и woff2
- сохраняет полученное содержимое в папку с билдом

`html`

_в режиме разработки_

- получает все файлы .pug из папки page в исходниках проекта
- компилирует в .html
- сохраняет полученное содержимое в папку с билдом

_в режиме сборки_

- получает все файлы .pug из папки page в исходниках проекта
- компилирует в .html
- производит подмену не svg картинок на webp
- сохраняет полученное содержимое в папку с билдом

```
// input
<img src="/img/image.jpg">
 
// output
<picture>
    <source srcset="/img/image.webp" type="image/webp">
    <img src="/img/image.jpg">
</picture>
```

Возможна работа задачи с исходными файлами в .html формате с использованием плагина __gulp-file-include__ для организации компонентов.

`img`

_в режиме разработки_

- получает файлы .jpg, .jpeg, .png, .gif, .webp (только новые) из папки img в исходниках проекта
- копирует полученное содержимое в папку с билдом
- получает файлы .svg (только новые) из папки img в исходниках проекта
- копирует полученное содержимое в папку с билдом

_в режиме сборки_

- получает файлы .jpg, .jpeg, .png, .gif, .webp (только новые) из папки img в исходниках проекта
- конвертирует .jpg, .jpeg, .png в .webp
- сохраняет полученное содержимое в папку с билдом
- получает файлы .jpg, .jpeg, .png, .gif, .webp (только новые) из папки img в исходниках проекта
- сжимает полученное содержимое
- сохраняет полученное содержимое в папку с билдом
- получает файлы .svg (только новые) из папки img в исходниках проекта
- копирует полученное содержимое в папку с билдом

`js`

_в режиме разработки_

- получает файл app.js из папки js в исходниках проекта
- пропускает через eslint
- пропускает через webpack (mode: 'development')
- переименовывает файл в app.min.js
- сохраняет полученное содержимое в папку с билдом

_в режиме сборки_

- получает файл app.js из папки js в исходниках проекта
- пропускает через eslint
- пропускает через webpack (mode: 'production')
- переименовывает файл в app.min.js
- сохраняет полученное содержимое в папку с билдом

`reset`

- удаляет папку с билдом

`scss`

_в режиме разработки_

- получает файл style.scss из папки style в исходниках проекта
- пропускает через stylelint
- компилирует в .css
- переименовывает файл в style.min.css
- сохраняет style.min.css в папку с билдом

_в режиме сборки_

- получает файл style.scss из папки style в исходниках проекта
- пропускает через stylelint
- компилирует в .css
- группирует медиа запросы
- пропускает через autoprefixer (last 3 versions)
- добавляет для background-image ссылку .webp картинку
- сохраняет файл style.css в папку с билдом
- сжимает содержимое
- переименовывает файл в style.min.css
- сохраняет style.min.css в папку с билдом

```
// input
.test { background-image:url('test.png'); }

// output
.test { background-image:url('test.png'); }
.webp .test { background-image:url('test.webp'); }
```

`server`

- запускает локальный сервер

`sprite`

- получает файлы .svg из папки icons в исходниках проекта
- генерирует svg спрайт
- созает файл sprite.svg в папке с билдом
